<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.110.0"><link rel=canonical type=text/html href=https://trustgrid.github.io/docs/docs/nodes/vpn/><link rel=alternate type=application/rss+xml href=https://trustgrid.github.io/docs/docs/nodes/vpn/index.xml><meta name=robots content="noindex, nofollow"><link rel="shortcut icon" href=/docs/favicons/favicon.ico><link rel=apple-touch-icon href=/docs/favicons/apple-touch-icon-180x180.png sizes=180x180><link rel=icon type=image/png href=/docs/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/docs/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/docs/favicons/android-36x36.png sizes=36x36><link rel=icon type=image/png href=/docs/favicons/android-48x48.png sizes=48x48><link rel=icon type=image/png href=/docs/favicons/android-72x72.png sizes=72x72><link rel=icon type=image/png href=/docs/favicons/android-96x96.png sizes=96x96><link rel=icon type=image/png href=/docs/favicons/android-144x144.png sizes=144x144><link rel=icon type=image/png href=/docs/favicons/android-192x192.png sizes=192x192><title>VPN |</title><meta name=description content="Trustgrid Network Device and API documentation"><meta property="og:title" content="VPN"><meta property="og:description" content="Trustgrid Network Device and API documentation"><meta property="og:type" content="website"><meta property="og:url" content="https://trustgrid.github.io/docs/docs/nodes/vpn/"><meta itemprop=name content="VPN"><meta itemprop=description content="Trustgrid Network Device and API documentation"><meta name=twitter:card content="summary"><meta name=twitter:title content="VPN"><meta name=twitter:description content="Trustgrid Network Device and API documentation"><link rel=preload href=/docs/scss/main.min.cd8ef62840094746f6b6a72f022aa002a82f35bfec4c2eff8212bf451c91cd1b.css as=style><link href=/docs/scss/main.min.cd8ef62840094746f6b6a72f022aa002a82f35bfec4c2eff8212bf451c91cd1b.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.6.0.min.js integrity=sha384-vtXRMe3mGCbOeY7l30aIg8H9p3GdeSe4IFlP6G8JMa7o7lXvnz3GFKzPxzJdPfGK crossorigin=anonymous></script>
<script defer src=https://unpkg.com/lunr@2.3.9/lunr.min.js integrity=sha384-203J0SNzyqHby3iU6hzvzltrWi/M41wOP5Gu+BiJMz5nwKykbkUx8Kp7iti0Lpli crossorigin=anonymous></script>
<link rel=stylesheet href=/docs/css/prism.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-99793053-3"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-99793053-3")}</script></head><body class=td-section><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/docs/><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 469 106"><defs><style>.cls-1{fill:#6b6b6b}.cls-2{fill:#226ce0}</style></defs><title>Trustgrid-Logo-Grey</title><path class="cls-1" d="M.35 28.58H29.26V-.33H.35zM7.13 6.45H22.47V21.8H7.13z"/><path class="cls-1" d="M67.82-.33H38.9V28.58H67.82zM61 21.8H45.68V6.45H61z"/><path class="cls-1" d="M.35 67.13H29.26V38.22H.35zM7.13 45H22.47V60.35H7.13z"/><path class="cls-1" d="M106.36 38.22H77.45v12.3H67.82V41.27L85.26 23.83l-3.06-3L64.76 38.22H38.9V67.13H67.82V54.83h9.63v12.3h12.3V80.39h4.31V67.13h12.3zM61 60.35H45.68V45H61zm38.55.0H84.23V45H99.58z"/><path class="cls-1" d="M.35 105.69H29.26V76.77H.35zM7.13 83.55H22.47V98.9H7.13z"/><path class="cls-1" d="M38.9 105.69H67.82V76.77H38.9zm6.78-22.14H61V98.9H45.68z"/><path class="cls-2" d="M153.94 77.54a18.64 18.64.0 01-10.1 3.17 11.44 11.44.0 01-8.3-3c-2.12-2-3.18-5.12-3.18-9.24V44.56h-6.11V38.78h6.11V27.22H140V38.78h13.2v5.78H140V67q0 3.59 1.31 5.13a4.8 4.8.0 003.91 1.55 13.59 13.59.0 006.67-2z"/><path class="cls-2" d="M176.74 39.56A18 18 0 01186 37.07V44.4q-6.58-.24-10.66 3.42a14.51 14.51.0 00-4.64 9.85V80.39h-7.57V37.32h7.57V46.6a15.52 15.52.0 016-7"/><path class="cls-2" d="M232.34 37.32V80.39h-7.65V71.27q-4.23 9.2-16 9.36-7.48.0-11.72-4.44t-4.24-12.25V37.32h7.66V61.9q0 5.46 3 8.51a10.87 10.87.0 008.18 3.06 12.11 12.11.0 009.57-4.28 16 16 0 003.54-10.7V37.32z"/><path class="cls-2" d="M260.47 44.24a21.21 21.21.0 00-6.15-1 10.48 10.48.0 00-5.49 1.26 4.21 4.21.0 00-2.08 3.87 4.3 4.3.0 002.32 4 34.68 34.68.0 007 2.73 54.86 54.86.0 017.33 2.6 13 13 0 014.85 3.83 10.51 10.51.0 012 6.67 10.58 10.58.0 01-4.6 9.29 19.65 19.65.0 01-11.44 3.17 28.35 28.35.0 01-9.32-1.55 21.07 21.07.0 01-7.61-4.39l2.85-5.54a20.07 20.07.0 006.63 3.91 22 22 0 007.69 1.47 11.45 11.45.0 006-1.39 4.61 4.61.0 002.28-4.23 4.82 4.82.0 00-2.4-4.4 32.85 32.85.0 00-7.29-2.93 48.4 48.4.0 01-7-2.48 12.43 12.43.0 01-4.64-3.71A10 10 0 01239.5 49q0-6 4.4-9a19.07 19.07.0 0111-3 27.13 27.13.0 017.69 1.1 23 23 0 016.56 3l-2.77 5.78a26 26 0 00-5.9-2.6"/><path class="cls-2" d="M303.42 77.54a18.64 18.64.0 01-10.1 3.17 11.44 11.44.0 01-8.3-3c-2.12-2-3.18-5.12-3.18-9.24V44.56h-6.11V38.78h6.11V27.22h7.65V38.78h13.19v5.78H289.49V67c0 2.39.44 4.1 1.3 5.13a4.81 4.81.0 003.91 1.55 13.62 13.62.0 006.68-2z"/><path class="cls-1" d="M352.92 36.34V76.48a19.18 19.18.0 01-3 10.71 19.61 19.61.0 01-8.43 7.08A29.79 29.79.0 01329 96.75a36.74 36.74.0 01-10.66-1.54 34 34 0 01-9-4.16l5.05-10a25.68 25.68.0 006.51 3.17 22.5 22.5.0 007.08 1.14 12.11 12.11.0 007.74-2.27 7.52 7.52.0 002.85-6.2V72.16Q334.12 77.95 326 78a17.69 17.69.0 01-16.41-10.14 24.71 24.71.0 01-2.4-11.12 24.42 24.42.0 012.32-10.91A17.35 17.35.0 01316 38.46a17.92 17.92.0 019.61-2.61A17.42 17.42.0 01333 37.36a14.36 14.36.0 015.5 4.35V36.34zM336.07 64.51a11 11 0 002.44-7.41 11.16 11.16.0 00-2.44-7.49 8.69 8.69.0 00-12.91.0 11 11 0 00-2.48 7.45 10.85 10.85.0 002.48 7.41 8.18 8.18.0 006.47 2.85 8.08 8.08.0 006.44-2.85"/><path class="cls-1" d="M383.9 37.8a16.63 16.63.0 018.26-2V49c-.49.0-1.22-.08-2.2-.08a13.4 13.4.0 00-8.3 2.4A9.18 9.18.0 00378 57.92V80.39H363.5v-44H378v7.33a16 16 0 015.9-5.87"/><path class="cls-1" d="M411.09 18.22a7.55 7.55.0 012.16 5.58 7.59 7.59.0 01-2.16 5.54 8 8 0 01-11 0 7.59 7.59.0 01-2.16-5.54 7.55 7.55.0 012.16-5.58 8.1 8.1.0 0111 0M398.51 36.34h14.41V80.39H398.51z"/><path class="cls-1" d="M468.45 20V80.39H454v-5.7a14.92 14.92.0 01-5.58 4.68A16.94 16.94.0 01440.93 81a20.15 20.15.0 01-10.75-2.85 19.16 19.16.0 01-7.2-8 26.51 26.51.0 01-2.57-11.93 25.77 25.77.0 012.53-11.72A18.6 18.6.0 01430 38.62a20.05 20.05.0 0110.59-2.77 17.24 17.24.0 017.61 1.63A16.19 16.19.0 01454 42.12V20zm-17.1 46.5A11.77 11.77.0 00454 58.57a11.76 11.76.0 00-2.61-8 8.58 8.58.0 00-6.84-3 8.67 8.67.0 00-6.88 3.05A11.69 11.69.0 00435 58.57a11.68 11.68.0 002.64 7.93 8.68 8.68.0 006.88 3.06 8.53 8.53.0 006.84-3.06"/><path class="cls-2" d="M99.58 21.8H84.23V6.46H99.58zM106.36-.33H77.45V28.59h28.91z"/><path class="cls-2" d="M99.58 98.9H84.23V83.55H99.58zm6.78-22.13H77.45v28.92h28.91z"/></svg></span><span class=navbar-brand__name></span></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/getting-started/><span>Getting Started</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class="nav-link active" href=/docs/docs/><span class=active>Documentation</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/tutorials/><span>Guides</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/help-center/><span>Help Center</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=/docs/release-notes/><span>Release Notes</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><div class="td-search td-search--offline"><div class=td-search__icon></div><input type=search class="td-search__input form-control" placeholder="Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/docs/offline-search-index.80e9026fdb5ee0497c80198fe3c64ab5.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main><div class=td-content><div class="pageinfo pageinfo-primary d-print-none"><p>This is the multi-page printable view of this section.
<a href=# onclick="return print(),!1">Click here to print</a>.</p><p><a href=/docs/docs/nodes/vpn/>Return to the regular view of this page</a>.</p></div><h1 class=title>VPN</h1><ul><li>1: <a href=#pg-900c3294b54df2ae1f523685155ffe0b>DNS</a></li><li>2: <a href=#pg-08853da200adfe5357ff18d4b5e6158c>Dynamic Routing</a></li><li>3: <a href=#pg-c181d836618306bbfdddca7c43ba4103>NATs</a></li><li>4: <a href=#pg-97c2667991f3a82dffa39a3c14315bd7>Port Forwarding</a></li><li>5: <a href=#pg-dfaf2586eec001c16d7973b3af3fc2aa>Static Routing</a></li><li>6: <a href=#pg-20ab08d0a7033f3ac55b1a0c701ebc91>WireGuard ®</a></li></ul><div class=content><div class="pageinfo pageinfo-primary"><p>Trustgrid nodes can be configured to provide VPN-like functionality, allowing network address translation (NAT) and routing between nodes.</p></div><p>The VPN feature enables routing of IP packets by utilizing a virtual IP space that is configured on the nodes. In this configuration, the node can be used as the next hop for route destined for the virtual IP space, or the node can be used as the default gateway for a network. The virtual IP space is used as a transit network with NAT being utilized to translate IP addresses on to/from the virtual IP space on either side. It is also possible to preserve the original source and destination by having the virtual IP space be identical to the LAN network.</p><p>The Trustgrid VPN feature provides the capability to securely route IP packets between remote networks. In this configuration, Trustgrid nodes can operate as a distributed mesh virtual private network (VPN) that can allow applications to access remote data and services at layer 3 (L3) of the network OSI model. This is done by defining a virtual L3 network (similar to an Amazon VPC) and then selecting how local node networks are exposed and translated into the the virtual address space.</p><h2 id=attaching-a-network>Attaching a Network</h2><p>To use VPN functionality, a node or cluster must be attached to a domain <a href=https://trustgrid.github.io/docs/docs/domain/virtual-networks/>virtual network</a>.</p><p>Navigate to the <code>VPN</code> section for your node or cluster, and select <code>Actions</code>-><code>Attach</code>.</p><p><img src=attach-network.png alt=img></p><tr><th>Network</th><td>The network name (defined on the domain) to attach</td></tr><tr><th>Network CIDR</th><td>The network CIDR</td></tr><tr><th>Validation CIDR</th><td>The network route CIDR</td></tr><tr><th>Virtual Management IP</th><td>The virtual IP address to use in this network</td></tr><p>Once attached, navigate into the network to manage the VPN configuration.</p></div></div><div class=td-content style=page-break-before:always><h1 id=pg-900c3294b54df2ae1f523685155ffe0b>1 - DNS</h1><p>Nodes can act as DNS servers for the virtual network. Find DNS definitions and change them under the <code>DNS</code> section of the VPN configuration.</p><p><img src=list.png alt=img></p><h2 id=upstream-servers>Upstream Servers</h2><p>Upstream servers will be used to answer DNS queries for domains that are not in the virtual network.</p><p><tr><th>Host IP Address</th><td>The upstream DNS server&rsquo;s IP address</td></tr><tr><th>Host Port</th><td>The upstream DNS server&rsquo;s port (usually 53)</td></tr></p></div><div class=td-content style=page-break-before:always><h1 id=pg-08853da200adfe5357ff18d4b5e6158c>2 - Dynamic Routing</h1><p>Dynamic routing allows a node to export and import routes from other nodes in the virtual network. Find dynamic route definitions and change them under the <code>Dynamic Routing</code> section of the VPN configuration.</p><p><img src=list.png alt=img></p><h2 id=exports>Exports</h2><p>Export routes for other nodes in the virtual network to import.</p><p><img src=add-export.png alt=img></p><p><tr><th>Destination</th><td>The node to route traffic to.</td></tr><tr><th>Destination CIDR</th><td>The network to route traffic to.</td></tr><tr><th>Metric</th><td>The route metric. Lower metrics are processed first.</td></tr><tr><th>Gateway Path</th><td>An optional gateway path to use for the route.</td></tr></p><h2 id=imports>Imports</h2><p>Import routes from other nodes in the virtual network.</p><p><img src=add-import.png alt=img></p><p><tr><th>Destination</th><td>The node to route traffic to.</td></tr><tr><th>Destination CIDR</th><td>The network to route traffic to.</td></tr><tr><th>Metric</th><td>The route metric. Lower metrics are processed first.</td></tr><tr><th>Gateway Path</th><td>An optional gateway path to use for the route.</td></tr></p></div><div class=td-content style=page-break-before:always><h1 id=pg-c181d836618306bbfdddca7c43ba4103>3 - NATs</h1><div class="pageinfo pageinfo-primary"><p>NATs allow Trustgrid to alter the source and/or destination IP address of layer 3 traffic as it enters or leaves the VPN.</p></div><h2 id=adding-an-interface>Adding an Interface</h2><p>NATs are scoped to an interface. Add an interface from the <code>Actions</code> menu.</p><p><img src=add-interface.png alt=img></p><h2 id=inside-nats>Inside NATs</h2><p>An inside NAT defines how a local device IP address translates into a virtual network address. For instance, a local device may have a local IP address of 192.168.1.100, but you may want it to appear to other devices or applications on the virtual network as IP address 10.0.20.100. Or you may want an entire block of local IP addresses to show up on the virtual network as a different block. You can do this translation via Inside NATs. Inside NAT&rsquo;s also control what local devices can participate on the virtual network. If a local device does not have an inside NAT configured that includes its IP address, it can&rsquo;t access or be accessed by other devices on the network. Inside NATs require the following information:</p><tr><th>Local CIDR</th><td>The local IP address or address block that should be mapped into the virtual network. It should be entered in CIDR block format (eg - <code>192.168.100.0/24</code> or <code>192.168.100.51/32</code>).</td></tr><tr><th>Virtual CIDR</th><td>The network IP address or addresses that the local IP addresses should be mapped to, also entered in CIDR block format.</td></tr><div class="alert alert-primary" role=alert>Network addresses map 1x1 with local addresses, so the prefix length (the /xx number of the CIDR) should be the same in both the local and network CIDR blocks of the inside NAT entry.</div><h2 id=outside-nats>Outside NATs</h2><p>By default, when a device on the local network of a node receives traffic from a remote device on the network, the remote device IP address will be the IP address that was entered in the local CIDR block for the remote node&rsquo;s inside NAT entry for the remote device. For instance, if the remote device was mapped to network address 10.0.100.1, then its traffic on the local network will appear to come from IP address 10.0.100.1. However due to the local network configuration, there may be some situations where it is desirable to translate remote network addresses before egressing onto the local network. For instance on a local network of 192.168.0.0/16, a user may want the remote devices virtual network IP of 10.0.100.1 to be translated to 192.168.50.5 so that it fits better into the local network setup. This kind of translation can be achieved by adding outside nats. To add an outside NAT you must enter the following information:</p><tr><th>Network Group</th><td>The network IP address or addresses that should be translated before egressing onto the local network. This should be entered in CIDR block format.</td></tr><tr><th>Local CIDR</th><td>The local IP address or addresses that the network addresses should be mapped to, also entered in CIDR format.</td></tr><div class="alert alert-primary" role=alert>An outside NAT is required for all nodes and clusters using the virtual network</div><p>Note there are situations where it may be desirable to make multiple remote devices masquerade as one local IP address though the use of port address translation (PAT). This can be achieved by defining an outside nat in which the network CIDR contains a larger address space than the local CIDR. For instance, an entry with network CIDR 10.0.1.0/24 and local CIDR 192.168.100.10 would make all remote devices with network IP addresses in 10.0.1.0/24 appear as IP address 192.168.100.10 on the local network.</p></div><div class=td-content style=page-break-before:always><h1 id=pg-97c2667991f3a82dffa39a3c14315bd7>4 - Port Forwarding</h1><p>Port forwarding allows a node to expose an <a href=https://trustgrid.github.io/docs/docs/nodes/services/>L4 service</a> on the virtual network.</p><p><img src=list.png alt=img></p><p><tr><th>Virtual IP Address</th><td>The IP to expose the service on the virtual network.</td></tr><tr><th>Virtual Port</th><td>The port to expose the service on the virtual network.</td></tr><tr><th>Local Service</th><td>The service to expose.</td></tr></p></div><div class=td-content style=page-break-before:always><h1 id=pg-dfaf2586eec001c16d7973b3af3fc2aa>5 - Static Routing</h1><p>Static routing allows a node to route traffic to a remote network. Find static route definitions and change them under the <code>Static Routing</code> section of the VPN configuration.</p><p><img src=add-modal.png alt=img></p><p><tr><th>Destination</th><td>The node to route traffic to.</td></tr><tr><th>Destination CIDR</th><td>The network to route traffic to.</td></tr><tr><th>Metric</th><td>The route metric. Lower metrics are processed first.</td></tr><tr><th>Gateway Path</th><td>An optional gateway path to use for the route.</td></tr></p></div><div class=td-content style=page-break-before:always><h1 id=pg-20ab08d0a7033f3ac55b1a0c701ebc91>6 - WireGuard ®</h1><p>Nodes may enable a WireGuard server to expose the virtual network to WireGuard clients.</p><h2 id=configuration>Configuration</h2><p><img src=wireguard.png alt=img></p><p><tr><th>Enabled</th><td>When enabled, this node will accept WireGuard client connections</td></tr><tr><th>Port</th><td>The port clients should connect to</td></tr><tr><th>Remote Traffic Forwarding</th><td>Whether the node should forward traffic to the virtual network</td></tr></p><h2 id=key-management>Key Management</h2><p>Clients will need the server&rsquo;s public key to connect. This can be generated (using the <code>Regenerate</code> action) or can be derived from the private key (imported using the <code>Import</code> action).</p><div class="alert alert-primary" role=alert>Changing the server&rsquo;s private key will disconnect existing clients and require their reconfiguration.</div><h2 id=clients>Clients</h2><p>Clients must be added before they can connect.</p><p><img src=wg-client.png alt=img></p><p>Each client will need to generate their own private and public key. Most WireGuard clients provide tools to do this.</p><p><tr><th>Name</th><td>The name of the client</td></tr><tr><th>Pre-shared Key</th><td>(Optional) The client&rsquo;s pre-shared key</td></tr><tr><th>Public Key</th><td>The client&rsquo;s public key</td></tr><tr><th>Allow Internet</th><td>Whether this client should be allowed to access the public network through this server</td></tr></p><p>An inside NAT should be created to map the client&rsquo;s local IP to an IP on the virtual network. The virtual network CIDR should not be a part of any existing routes in the domain. The IP should be included in an outside NAT network group, so that an ACL can allow the traffic.</p><p>An outside NAT should be created that includes the virtual network used on the gateway side.</p><p><em>&ldquo;WireGuard&rdquo; is a registered trademark of Jason A. Donenfeld.</em></p></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=LinkedIn aria-label=LinkedIn><a class=text-white target=_blank rel=noopener href=https://www.linkedin.com/company/trustgrid/ aria-label=LinkedIn><i class="fab fa-linkedin"></i></a></li></ul></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"><ul class="list-inline mb-0"><li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub><a class=text-white target=_blank rel=noopener href=https://github.com/trustgrid aria-label=GitHub><i class="fab fa-github"></i></a></li></ul></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"><small class=text-white>&copy; 2023 Trustgrid All Rights Reserved</small>
<small class=ml-1><a href=https://trustgrid.io target=_blank rel=noopener>Privacy Policy</a></small></div></div></div></footer></div><script src=/docs/js/main.min.f1a20e761a85478d0ce3298a01e295324be8858ef8f2d2baac6737980799b320.js integrity="sha256-8aIOdhqFR40M4ymKAeKVMkvohY748tK6rGc3mAeZsyA=" crossorigin=anonymous></script>
<script src=/docs/js/prism.js></script>
<script src=/docs/js/tabpane-persist.js></script></body></html>